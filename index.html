<!DOCTYPE html>
<html lang="es" data-base-path="">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carmen & Alfredo, 8 de noviembre de 2025</title>
  <meta name="description" content="Acompáñanos el 8 de noviembre de 2025 en Villa La Perla, Calvillo. Guarda la fecha, conoce el itinerario y comparte tus recuerdos de la boda civil de Carmen y Alfredo." />
  <link rel="icon" type="image/png" href="favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;500;600;700&family=Lato:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.tailwindcss.com?plugins=typography" defer></script>
  <script>
    tailwind = window.tailwind || {};
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ivory: '#FAF7F2',
            champagne: '#E7D8C9',
            forest: '#2F4F4F',
            sage: '#8DA08C',
            gold: '#C2A675'
          },
          fontFamily: {
            display: ['"Great Vibes"', 'cursive'],
            serif: ['"Playfair Display"', 'serif'],
            sans: ['Lato', 'sans-serif']
          },
          boxShadow: {
            petal: '0 32px 60px -40px rgba(47, 79, 79, 0.68)'
          }
        }
      }
    };
  </script>
  <style type="text/tailwindcss">
    @layer base {
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: theme('fontFamily.sans');
        color: var(--forest);
      }
      h1, h2, h3, h4 {
        font-family: theme('fontFamily.serif');
        color: var(--forest);
      }
      h1 {
        font-family: theme('fontFamily.display');
      }
      ::selection {
        background: rgba(194, 166, 117, 0.35);
        color: var(--forest);
      }
      .prose {
        color: rgba(47, 79, 79, 0.9);
      }
      .prose strong {
        color: rgba(47, 79, 79, 0.95);
      }
    }
  </style>
  <link rel="stylesheet" href="styles.css" />
  <meta property="og:type" content="event" />
  <meta property="og:title" content="Boda de Carmen & Alfredo — 8 de noviembre de 2025" />
  <meta property="og:description" content="Celebremos juntos en Villa La Perla, Calvillo. Consulta el itinerario, la ubicación y comparte tus recuerdos." />
  <meta property="og:image" content="https://boda-cya.github.io/images/Foto%20(1).jpg" />
  <meta property="og:url" content="https://boda-cya.github.io/" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Boda civil de Carmen & Alfredo" />
  <meta name="twitter:description" content="El 8 de noviembre de 2025 nos casamos en Villa La Perla, Calvillo. Guarda la fecha y vive con nosotros cada detalle." />
  <meta name="twitter:image" content="https://boda-cya.github.io/images/Foto%20(1).jpg" />
  <link rel="canonical" href="https://boda-cya.github.io/" />
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Event",
      "name": "Boda civil de Carmen y Alfredo",
      "description": "Ceremonia civil y celebración en Villa La Perla, Calvillo, Aguascalientes.",
      "startDate": "2025-11-08T13:00:00-06:00",
      "eventStatus": "https://schema.org/EventScheduled",
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "image": "https://boda-cya.github.io/images/Foto%20(1).jpg",
      "location": {
        "@type": "Place",
        "name": "Villa La Perla",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Reserva La Calixtina",
          "addressLocality": "Calvillo",
          "addressRegion": "Aguascalientes",
          "addressCountry": "MX"
        }
      },
      "organizer": {
        "@type": "Person",
        "name": "Carmen & Alfredo"
      },
      "url": "https://boda-cya.github.io/"
    }
  </script>
</head>
<body class="bg-ivory/95 antialiased text-base">
  <div class="min-h-screen">
    <header class="relative isolate flex min-h-screen items-center justify-center overflow-hidden" data-hero>
      <div class="w-full max-w-4xl mx-auto px-5 sm:px-6 lg:px-8 py-24 sm:py-32 text-center">
        <p class="uppercase tracking-[0.35em] text-sm sm:text-base text-forest/70">Nos casamos</p>
        <div class="mt-10 flex flex-col items-center gap-6 sm:gap-8">
          <img
            src="adorno_arriba.png"
            alt=""
            class="hero-floral pointer-events-none hidden h-12 w-64 max-w-full text-gold sm:block sm:h-14 sm:w-80"
            aria-hidden="true"
            data-hero-floral
          />
          <div class="flex flex-col items-center gap-4 sm:gap-5">
            <div class="hero-mobile-adornment">
              <h1
                class="font-display text-[3.2rem] sm:text-[4.8rem] leading-none tracking-tight drop-shadow-sm flex flex-col items-center justify-center gap-1 sm:flex-row sm:gap-2 w-fit mx-auto"
                data-hero-names
                data-site-brand
              >
                <span>Carmen</span>
                <span>y</span>
                <span>Alfredo </span>
              </h1>
            </div>
            <div class="font-serif text-xl text-forest/80 text-center flex flex-col items-center gap-1 sm:hidden w-fit mx-auto">
              <span>8 de noviembre de 2025</span>
              <span>Villa La Perla</span>
              <span>Calvillo</span>
              <span>Aguascalientes</span>
            </div>
            <p
              class="font-serif text-xl sm:text-2xl text-forest/80 text-center hidden sm:block w-fit mx-auto"
              data-hero-date
            >
              8 de noviembre de 2025 · Villa La Perla, Calvillo, Aguascalientes
            </p>
          </div>
          <img
            src="adorno_abajo.png"
            alt=""
            class="hero-floral pointer-events-none hidden h-12 w-64 max-w-full text-gold sm:block sm:h-14 sm:w-80"
            aria-hidden="true"
            data-hero-floral
          />
        </div>
      </div>
    </header>

    <main class="max-w-4xl mx-auto px-5 sm:px-6 lg:px-8 space-y-16 py-12 sm:py-16">
      <section id="contador" class="reveal">
        <div class="section-card rounded-3xl bg-white/70 backdrop-blur-sm border border-white/40 shadow-petal p-8 sm:p-10">
          <h2 class="text-2xl sm:text-3xl font-semibold tracking-wide text-center">La cuenta regresiva comenzó</h2>
          <p class="mt-4 text-center text-base sm:text-lg text-forest/70">Falta cada vez menos para abrazarnos y brindar juntos por nuestra historia.</p>
          <dl class="mt-8 grid grid-cols-2 gap-4 sm:grid-cols-4">
            <div class="flex flex-col items-center rounded-2xl bg-white/80 px-4 py-6 shadow-lg shadow-forest/5">
              <dt class="text-xs uppercase tracking-[0.4em] text-forest/50">Días</dt>
              <dd id="days" class="mt-3 text-4xl sm:text-5xl font-semibold text-forest">00</dd>
            </div>
            <div class="flex flex-col items-center rounded-2xl bg-white/80 px-4 py-6 shadow-lg shadow-forest/5">
              <dt class="text-xs uppercase tracking-[0.4em] text-forest/50">Horas</dt>
              <dd id="hours" class="mt-3 text-4xl sm:text-5xl font-semibold text-forest">00</dd>
            </div>
            <div class="flex flex-col items-center rounded-2xl bg-white/80 px-4 py-6 shadow-lg shadow-forest/5">
              <dt class="text-xs uppercase tracking-[0.4em] text-forest/50">Min</dt>
              <dd id="minutes" class="mt-3 text-4xl sm:text-5xl font-semibold text-forest">00</dd>
            </div>
            <div class="flex flex-col items-center rounded-2xl bg-white/80 px-4 py-6 shadow-lg shadow-forest/5">
              <dt class="text-xs uppercase tracking-[0.4em] text-forest/50">Seg</dt>
              <dd id="seconds" class="mt-3 text-4xl sm:text-5xl font-semibold text-forest">00</dd>
            </div>
          </dl>
        </div>
      </section>

      <section id="mensaje" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/60 bg-ivory/90 p-8 sm:p-10 shadow-petal" data-invitee-card>
          <h2 class="text-center font-serif text-3xl sm:text-4xl tracking-tight text-forest" data-invitee-heading>
            Estimados familiares y amigos
          </h2>
          <div class="mt-5 flex justify-center" aria-hidden="true">
            <span class="inline-flex h-12 w-12 items-center justify-center rounded-full border border-gold/40 bg-champagne/40 text-2xl text-gold">
              <i class="fa-solid fa-ring"></i>
            </span>
          </div>
          <div class="mt-6 hidden text-center" data-invitee-loading role="status" aria-live="polite">
            <span class="inline-flex items-center gap-2 rounded-full bg-white/80 px-4 py-2 text-sm font-medium text-forest/60 shadow-inner">
              <span class="h-2 w-2 animate-pulse rounded-full bg-gold/70" aria-hidden="true"></span>
              Personalizando invitación…
            </span>
          </div>
          <div class="prose prose-lg max-w-3xl mx-auto text-center mt-6" data-invitee-generic>
            <p>Con gran emoción tenemos el honor de invitarles a ser testigos de la formalización de nuestro compromiso. Después de un camino compartido, hemos decidido unir nuestras vidas en el marco de una ceremonia civil.</p>
            <p>Será un privilegio contar con su presencia, siendo su compañía el más valioso de los regalos. Les esperamos para compartir una velada honrando los valores del respeto, la igualdad y la unión libremente elegida.</p>
          </div>
          <div
            class="mx-auto mt-8 hidden max-w-2xl flex flex-col items-center gap-6 rounded-3xl border border-champagne/60 bg-ivory px-6 py-8 text-center shadow-[0_24px_60px_-34px_rgba(47,79,79,0.6)]"
            data-invitee-personalized
            aria-live="polite"
          >
            <p data-invitee-general class="text-lg sm:text-xl leading-relaxed text-forest/95"></p>
            <p data-invitee-seats class="text-base sm:text-lg font-semibold text-forest"></p>
            <p data-invitee-note class="text-sm sm:text-base text-forest/80 hidden"></p>
          </div>
          <div class="mt-8 flex flex-col items-center gap-4 hidden" data-invitee-actions>
            <div class="flex w-full flex-col items-center gap-3 sm:flex-row sm:justify-center" data-invitee-buttons>
              <a
                class="button button--primary button--sm button--responsive"
                data-invitee-whatsapp-groom
                href="#"
                target="_blank"
                rel="noopener"
                role="button"
                aria-label="Confirmar asistencia con Alfredo por WhatsApp"
              >
                <i class="fa-brands fa-whatsapp"></i>
                Confirmar con el Novio
              </a>
              <a
                class="button button--outline button--sm button--responsive"
                data-invitee-whatsapp-bride
                href="#"
                target="_blank"
                rel="noopener"
                role="button"
                aria-label="Confirmar asistencia con Carmen por WhatsApp"
              >
                <i class="fa-brands fa-whatsapp"></i>
                Confirmar con la Novia
              </a>
            </div>
            <p class="text-center text-sm text-forest/70 hidden" data-invitee-cta-text></p>
          </div>
        </div>
      </section>

      <section id="lema" class="reveal">
        <div class="section-card relative overflow-hidden rounded-3xl bg-white/80 p-8 sm:p-12 text-center shadow-petal">
          <div class="absolute inset-x-16 top-0 h-px bg-gradient-to-r from-transparent via-gold/60 to-transparent"></div>
          <blockquote class="mt-2 font-serif text-3xl sm:text-4xl text-forest/90 tracking-tight">« Ubi Tu, Ibi Ego »</blockquote>
          <div class="mt-4 text-base sm:text-lg text-forest/70">— Donde tú estés, yo estaré —</div>
          <div class="absolute inset-x-16 bottom-0 h-px bg-gradient-to-r from-transparent via-gold/60 to-transparent"></div>
        </div>
      </section>

      <section id="cancion" class="reveal">
        <div class="section-card grid gap-8 rounded-3xl border border-champagne/60 bg-white/80 p-8 sm:p-10 shadow-petal sm:grid-cols-[1fr_2fr] text-center">
          <div class="flex flex-col items-center text-center">
            <h2 class="text-2xl sm:text-3xl font-semibold">Nuestra canción</h2>
            <p class="mt-4 text-base sm:text-lg leading-8 text-forest/80">La letra de esta canción resume la promesa que nos hacemos: acompañarnos en cada paso del camino, hoy y siempre. Es el himno de nuestro compromiso.</p>
            <div class="mt-6 flex flex-wrap items-center justify-center gap-3">
              <a href="https://open.spotify.com/intl-es/track/5bEn5VKDd0sD1uL2ZRCM05?si=f7cd05fc9bf444b3" target="_blank" rel="noopener" class="button button--spotify button--sm button--no-transform"><i class="fa-brands fa-spotify"></i> Spotify</a>
              <a href="https://music.apple.com/mx/song/hasta-mi-final/159707665" target="_blank" rel="noopener" class="button button--apple button--sm button--no-transform"><i class="fa-brands fa-apple"></i> Apple Music</a>
            </div>
          </div>
          <div class="flex flex-col justify-center rounded-3xl bg-gradient-to-br from-gold/80 via-champagne/95 to-white/95 p-6 text-center shadow-[0_30px_70px_-28px_rgba(194,166,117,0.55)] ring-2 ring-gold/60">
            <div class="flex flex-col items-center gap-5 sm:flex-row sm:items-center sm:justify-center">
              <img src="portada_cancion.png" alt="Portada del álbum Ancora de Il Divo" width="160" height="160" class="h-28 w-28 rounded-3xl object-cover shadow-lg shadow-forest/15" loading="lazy" decoding="async" />
              <div class="space-y-2 text-center text-forest">
                <h3 class="font-serif text-xl text-forest">Hasta mi final</h3>
                <p class="text-sm uppercase tracking-[0.35em] text-forest/70">Il Divo</p>
                <button data-audio-toggle aria-pressed="false" aria-label="Reproducir o pausar 'Hasta mi final'" class="mt-4 button button--primary button--icon">
                  <i class="fa-solid fa-play"></i>
                </button>
              </div>
            </div>
            <div class="mt-6">
              <label for="audio-progress" class="block text-xs uppercase tracking-[0.35em] text-forest/60 text-center">Progreso</label>
              <input id="audio-progress" type="range" min="0" max="100" value="0" class="mt-2 w-full cursor-pointer" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Progreso de la canción" />
            </div>
            <audio id="wedding-audio" preload="metadata" class="hidden">
              <source src="romantic-music.mp3" type="audio/mpeg" />
              Tu navegador no soporta la reproducción de audio.
            </audio>
          </div>
        </div>
      </section>

      <section id="ubicacion" class="reveal">
        <div class="section-card overflow-hidden rounded-3xl border border-champagne/70 bg-white/85 shadow-petal text-center">
          <div class="flex flex-col items-center gap-6 p-8 sm:p-10 text-center w-full">
            <div class="flex w-full max-w-3xl flex-col items-center gap-4 mx-auto">
              <div class="text-center">
                <h2 class="text-2xl sm:text-3xl font-semibold flex items-center justify-center gap-3"><span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-sage/25 text-forest"><i class="fa-solid fa-map-location-dot"></i></span>Ubicación</h2>
                <p class="mt-2 text-base sm:text-lg text-forest/75">Villa La Perla · Reserva La Calixtina · Calvillo, Aguascalientes</p>
              </div>
              <div class="w-full">
                <img src="Logo_Villa_la_Perla.png" alt="Logotipo de Villa La Perla" class="w-full h-auto rounded-3xl bg-white/80 p-4 shadow-inner" loading="lazy" decoding="async" />
              </div>
            </div>
            <div class="w-full max-w-3xl rounded-2xl overflow-hidden shadow-lg shadow-forest/10 mx-auto">
              <div class="aspect-video">
                <iframe title="Mapa de Villa La Perla" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4394.026996501516!2d-102.7768482241435!3d21.807530560574886!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8429cb00636cc6c5%3A0x1845a654b7b07076!2sVilla%20la%20Perla!5e1!3m2!1ses-419!2smx!4v1747757358727!5m2!1ses-419!2smx" class="h-full w-full border-0" allowfullscreen loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
              </div>
            </div>
            <div class="flex w-full max-w-3xl flex-wrap justify-center gap-4 mx-auto">
              <a href="https://maps.app.goo.gl/9xNsZ9sC9aUm9djp8" target="_blank" rel="noopener" class="button button--primary button--sm button--wide"><i class="fa-brands fa-google"></i> Google Maps</a>
              <a href="https://maps.apple.com/?q=Villa+La+Perla&ll=21.8075305,-102.7768482" target="_blank" rel="noopener" class="button button--outline button--sm button--wide"><i class="fa-brands fa-apple"></i> Apple Maps</a>
            </div>
          </div>
        </div>
      </section>

      <section id="itinerario" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/70 bg-white/80 p-8 sm:p-10 shadow-petal text-center">
          <h2 class="text-2xl sm:text-3xl font-semibold text-center">Itinerario</h2>
          <div class="mt-8 grid grid-cols-1 gap-6">
            <article class="rounded-2xl bg-white/85 p-6 text-center shadow-lg shadow-forest/5 transition duration-300 hover:-translate-y-1 hover:shadow-xl">
              <div class="flex flex-col items-center gap-4">
                <div class="flex h-16 w-16 items-center justify-center rounded-full bg-gold/15 text-gold text-3xl shadow-lg shadow-gold/30 border-0">
                  <i class="fa-solid fa-people-roof" aria-hidden="true"></i>
                </div>
                <div class="inline-flex items-center justify-center rounded-full bg-sage/25 px-4 py-2 text-sm font-semibold text-forest border-0">13:00 h</div>
              </div>
              <h3 class="mt-6 font-serif text-xl text-forest">Recepción</h3>
              <p class="mt-2 text-forest/75">Nos encontraremos para darnos la bienvenida con sonrisas, abrazos y la mejor energía.</p>
            </article>
            <article class="rounded-2xl bg-champagne/35 p-6 text-center shadow-lg shadow-forest/5 transition duration-300 hover:-translate-y-1 hover:shadow-xl">
              <div class="flex flex-col items-center gap-4">
                <div class="flex h-16 w-16 items-center justify-center rounded-full bg-gold/15 text-gold text-3xl shadow-lg shadow-gold/30 border-0">
                  <i class="fa-solid fa-ring" aria-hidden="true"></i>
                </div>
                <div class="inline-flex items-center justify-center rounded-full bg-sage/25 px-4 py-2 text-sm font-semibold text-forest border-0">14:00 h</div>
              </div>
              <h3 class="mt-6 font-serif text-xl text-forest">Ceremonia civil</h3>
              <p class="mt-2 text-forest/75">Testigos de nuestras palabras de amor y del compromiso de caminar juntos toda la vida.</p>
            </article>
            <article class="rounded-2xl bg-white/85 p-6 text-center shadow-lg shadow-forest/5 transition duration-300 hover:-translate-y-1 hover:shadow-xl">
              <div class="flex flex-col items-center gap-4">
                <div class="flex h-16 w-16 items-center justify-center rounded-full bg-gold/15 text-gold text-3xl shadow-lg shadow-gold/30 border-0">
                  <i class="fa-solid fa-champagne-glasses" aria-hidden="true"></i>
                </div>
                <div class="inline-flex items-center justify-center rounded-full bg-sage/25 px-4 py-2 text-sm font-semibold text-forest border-0">15:30 h</div>
              </div>
              <h3 class="mt-6 font-serif text-xl text-forest">Celebración</h3>
              <p class="mt-2 text-forest/75">Brindaremos, bailaremos y seguiremos sumando memorias inolvidables con cada uno de ustedes.</p>
            </article>
          </div>
        </div>
      </section>

      <section id="galeria" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/70 bg-white/80 p-8 sm:p-10 shadow-petal">
          <h2 class="text-2xl sm:text-3xl font-semibold text-center">Nuestros momentos</h2>
          <div class="mt-8 columns-1 gap-4 sm:columns-2 lg:columns-3">
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (1).jpg" alt="Carmen y Alfredo celebrando un cumpleaños" width="2048" height="1536" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Cumpleaños de Carmen" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (2).jpg" alt="Carmen y Alfredo asistiendo a una boda" width="2048" height="2048" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Asistiendo a una boda" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (3).jpg" alt="Camino a un concierto" width="2048" height="1536" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="En camino a un concierto" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (4).jpg" alt="Navidad en pareja" width="2048" height="1536" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Navidad" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (5).jpg" alt="Viaje a San Miguel de Allende" width="2048" height="1536" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="San Miguel de Allende" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (6).jpg" alt="Tomando una bebida refrescante" width="2048" height="1536" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Una cheve pa'l calor" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (7).jpg" alt="Paseo por Isla Mujeres" width="2048" height="941" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Isla Mujeres" />
            </figure>
            <figure class="mb-4 break-inside-avoid">
              <img src="images/Foto (8).jpg" alt="Hacienda de Pabellón de Hidalgo" width="1600" height="1597" loading="lazy" decoding="async" class="gallery-image w-full rounded-2xl object-cover shadow-lg shadow-forest/10 transition duration-300 hover:-translate-y-1 hover:shadow-xl blur-up" data-caption="Hacienda de Pabellón de Hidalgo" />
            </figure>
          </div>
        </div>
      </section>

      <section id="codigo" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/70 bg-white/80 p-8 sm:p-10 shadow-petal">
          <h2 class="text-2xl sm:text-3xl font-semibold text-center">Código de vestimenta</h2>
          <p class="mt-4 text-center text-base sm:text-lg text-forest/70">Un estilo formal de día con toques románticos será perfecto para disfrutar la tarde y la noche en el jardín.</p>
          <div class="mt-6 flex flex-wrap items-center justify-center gap-3">
            <span class="inline-flex items-center gap-2 rounded-full bg-sage/25 px-4 py-2 text-sm font-semibold text-forest"><i class="fa-solid fa-person-dress"></i>Vestido midi vaporoso</span>
            <span class="inline-flex items-center gap-2 rounded-full bg-sage/25 px-4 py-2 text-sm font-semibold text-forest"><i class="fa-solid fa-shoe-prints"></i>Calzado cómodo para jardín</span>
            <span class="inline-flex items-center gap-2 rounded-full border border-gold/60 bg-white/60 px-4 py-2 text-sm font-medium text-forest/70"><i class="fa-solid fa-circle-xmark text-gold"></i>Evitar tonos neón</span>
          </div>
        </div>
      </section>

      <section id="lluvia" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/70 bg-white/85 p-8 sm:p-10 shadow-petal text-center">
          <div class="flex flex-col items-center gap-4 text-center">
            <div class="flex h-16 w-16 items-center justify-center rounded-full bg-gold/20 text-gold">
              <i class="fa-solid fa-envelope-open-text text-2xl"></i>
            </div>
            <h2 class="mt-0 text-2xl sm:text-3xl font-semibold">Lluvia de sobres</h2>
          </div>
          <p class="mt-6 text-base sm:text-lg leading-8 text-forest/80">Su presencia es el obsequio más valioso que podemos recibir en este día tan importante. Si además desean tener un detalle, les agradeceremos que nos acompañen en la tradición de la “Lluvia de Sobres”.</p>
          <div
            class="bank-card mt-8"
            data-bank-card
            role="button"
            tabindex="0"
            aria-expanded="false"
            aria-controls="bank-card-details"
            aria-label="Mostrar datos bancarios para transferencias"
          >
            <div class="bank-card__inner" data-bank-card-inner>
              <div class="bank-card__face bank-card__face--front">
                <div class="bank-card__icon">
                  <i class="fa-solid fa-credit-card"></i>
                </div>
                <p class="bank-card__title">Datos bancarios</p>
                <p class="bank-card__subtitle">Toca para descubrir las CLABE de la lluvia de sobres</p>
              </div>
              <div class="bank-card__face bank-card__face--back" id="bank-card-details">
                <p class="bank-card__title">Transferencias bancarias</p>
                <p class="bank-card__subtitle">Elige una opción para copiar la CLABE</p>
                <div class="bank-card__actions" role="group" aria-label="Copiar CLABE bancaria">
                  <button
                    type="button"
                    class="bank-card__copy-button"
                    data-clabe="072010001847417938"
                    data-label="Novio"
                    aria-label="Copiar CLABE del Novio: 072010001847417938"
                  >
                    <span class="bank-card__copy-title">Novio</span>
                    <span class="bank-card__copy-value">072010001847417938</span>
                    <span class="bank-card__copy-hint">Toca para copiar</span>
                  </button>
                  <button
                    type="button"
                    class="bank-card__copy-button"
                    data-clabe="072010008246528052"
                    data-label="Novia"
                    aria-label="Copiar CLABE de la Novia: 072010008246528052"
                  >
                    <span class="bank-card__copy-title">Novia</span>
                    <span class="bank-card__copy-value">072010008246528052</span>
                    <span class="bank-card__copy-hint">Toca para copiar</span>
                  </button>
                </div>
                <p class="bank-card__feedback" data-bank-card-feedback aria-live="polite"></p>
              </div>
            </div>
          </div>
          <a href="boda_carmen_alfredo.ics" class="mt-10 button button--outline button--sm button--responsive">Añadir a mis recordatorios</a>
        </div>
      </section>

      <section id="recuerdos" class="reveal">
        <div class="section-card rounded-3xl border border-champagne/70 bg-white/80 p-8 sm:p-10 shadow-petal">
          <h2 class="text-2xl sm:text-3xl font-semibold text-center">Comparte tus recuerdos</h2>
          <p class="mt-4 text-center text-base sm:text-lg text-forest/75">Queremos atesorar cada instante de este día mágico. Comparte tus fotos y videos con nosotros para revivirlos una y otra vez.</p>
          <div class="mt-8 flex flex-col items-center gap-6 sm:flex-row sm:justify-center">
            <canvas id="qr-canvas" width="180" height="180" class="rounded-2xl border border-gold/60 bg-white p-2 shadow-inner" aria-label="Código QR para compartir tus fotos"></canvas>
            <div class="text-center">
              <a href="https://mega.nz/filerequest/QHyE53BPyTg" target="_blank" rel="noopener" class="button button--primary button--sm">Subir fotos y videos</a>
              <p class="mt-4 text-sm text-forest/60">El enlace y el código QR dirigen al mismo espacio en MEGA. Solo nosotros administraremos los archivos compartidos.</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="mt-16 px-5 sm:px-6 lg:px-8 pb-12">
      <div class="section-card mx-auto max-w-4xl rounded-3xl border border-champagne/70 bg-white/80 px-6 py-8 text-center text-sm text-forest/70 shadow-petal">
        <p>Gracias por acompañarnos con tanto cariño. Con amor, Carmen &amp; Alfredo.</p>
        <p class="mt-4 text-xs text-forest/60">Sitio elaborado con amor por <a href="https://fixtechpro.com.mx" target="_blank" rel="noopener" class="font-semibold text-forest hover:text-gold">Fix Tech Pro</a>.</p>
      </div>
    </footer>
  </div>

  <div id="lightbox" role="dialog" aria-modal="true" aria-label="Galería de recuerdos" tabindex="-1">
    <img id="lightbox-img" src="" alt="" />
    <div class="lightbox-caption" id="lightbox-caption"></div>
    <div class="controls">
      <button type="button" id="lightbox-prev" aria-label="Foto anterior" class="button button--overlay button--sm"><i class="fa-solid fa-arrow-left"></i></button>
      <button type="button" id="lightbox-next" aria-label="Foto siguiente" class="button button--overlay button--sm"><i class="fa-solid fa-arrow-right"></i></button>
      <button type="button" id="lightbox-close" aria-label="Cerrar galería" class="button button--overlay button--sm"><i class="fa-solid fa-xmark"></i></button>
    </div>
  </div>

  <nav id="mobile-action-bar" class="mobile-action-bar hidden" aria-label="Acciones rápidas">
    <a href="boda_carmen_alfredo.ics" download="Boda_Carmen_Alfredo.ics" class="button button--primary button--sm"><i class="fa-solid fa-calendar-check"></i>Guardar fecha</a>
    <a href="#ubicacion" class="button button--outline button--sm"><i class="fa-solid fa-map-pin button__icon-gold"></i>¿Cómo llegar?</a>
  </nav>

  <script src="scripts/message-utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const originalTitle = document.title;
      const rootDataset = document.documentElement.dataset || {};
      const SPA_REDIRECT_KEY = 'invitation-spa-redirect';

      const sanitizeBasePath = value => {
        if (typeof value !== 'string') return '';
        const trimmed = value.trim();
        if (!trimmed || trimmed === '/') return '';
        const normalized = trimmed.replace(/^\/+|\/+$/g, '');
        return normalized ? `/${normalized}` : '';
      };

      const invitationConfig = {
        basePath: sanitizeBasePath(rootDataset.basePath || ''),
        dataUrl: rootDataset.inviteesUrl || 'data/invitados.json',
        tokenParam: rootDataset.inviteTokenParam || 't'
      };

      const invitationElements = {
        card: document.querySelector('[data-invitee-card]'),
        heading: document.querySelector('[data-invitee-heading]'),
        generic: document.querySelector('[data-invitee-generic]'),
        personalized: document.querySelector('[data-invitee-personalized]'),
        generalMessage: document.querySelector('[data-invitee-general]'),
        seatsMessage: document.querySelector('[data-invitee-seats]'),
        note: document.querySelector('[data-invitee-note]'),
        actions: document.querySelector('[data-invitee-actions]'),
        whatsappGroom: document.querySelector('[data-invitee-whatsapp-groom]'),
        whatsappBride: document.querySelector('[data-invitee-whatsapp-bride]'),
        ctaText: document.querySelector('[data-invitee-cta-text]'),
        loading: document.querySelector('[data-invitee-loading]'),
        brand: document.querySelector('[data-site-brand]')
      };

      const restoreSpaPath = () => {
        try {
          if (!window.sessionStorage) return;
        } catch (error) {
          return;
        }

        let storedPath;
        try {
          storedPath = window.sessionStorage.getItem(SPA_REDIRECT_KEY);
        } catch (error) {
          return;
        }

        if (!storedPath) return;

        try {
          window.sessionStorage.removeItem(SPA_REDIRECT_KEY);
          const url = new URL(storedPath, window.location.origin);
          const target = `${url.pathname}${url.search}${url.hash}`;
          if (target && target !== window.location.pathname) {
            window.history.replaceState(null, '', target);
          }
        } catch (error) {
          console.error('No fue posible restaurar la ruta solicitada.', error);
        }
      };

      const toggleHidden = (element, shouldHide) => {
        if (!element) return;
        element.classList.toggle('hidden', Boolean(shouldHide));
      };

      const setCtaMessage = message => {
        if (!invitationElements.ctaText) return;
        invitationElements.ctaText.textContent = message || '';
        toggleHidden(invitationElements.ctaText, !message);
      };

      const setCardState = state => {
        if (!invitationElements.card) return;
        if (state) {
          invitationElements.card.dataset.inviteeState = state;
        } else {
          delete invitationElements.card.dataset.inviteeState;
        }
      };

      const setLoading = isLoading => {
        if (invitationElements.card) {
          invitationElements.card.setAttribute('aria-busy', String(Boolean(isLoading)));
        }
        toggleHidden(invitationElements.loading, !isLoading);
        if (isLoading) {
          toggleHidden(invitationElements.actions, true);
          setCtaMessage('');
        }
      };

      const resetPersonalizedFields = () => {
        if (invitationElements.generalMessage) {
          invitationElements.generalMessage.textContent = '';
        }
        if (invitationElements.seatsMessage) {
          invitationElements.seatsMessage.textContent = '';
          toggleHidden(invitationElements.seatsMessage, true);
        }
        if (invitationElements.note) {
          invitationElements.note.textContent = '';
          invitationElements.note.classList.add('hidden');
        }
        if (invitationElements.whatsappGroom) {
          invitationElements.whatsappGroom.href = '#';
          invitationElements.whatsappGroom.setAttribute('aria-label', 'Confirmar asistencia con Alfredo por WhatsApp');
          invitationElements.whatsappGroom.classList.add('hidden');
        }
        if (invitationElements.whatsappBride) {
          invitationElements.whatsappBride.href = '#';
          invitationElements.whatsappBride.setAttribute('aria-label', 'Confirmar asistencia con Carmen por WhatsApp');
          invitationElements.whatsappBride.classList.add('hidden');
        }
        toggleHidden(invitationElements.actions, true);
        setCtaMessage('');
      };

      const showGenericView = () => {
        resetPersonalizedFields();
        toggleHidden(invitationElements.generic, false);
        toggleHidden(invitationElements.personalized, true);
        toggleHidden(invitationElements.actions, true);
        if (invitationElements.heading) {
          invitationElements.heading.textContent = 'Estimados familiares y amigos';
        }
        if (invitationElements.brand) {
          invitationElements.brand.removeAttribute('title');
        }
        document.title = originalTitle;
        setCardState('generic');
      };

      const showPersonalizedView = invitee => {
        if (!invitee) return;
        if (!window.InvitationMessaging || typeof window.InvitationMessaging.buildInviteMessage !== 'function') {
          console.warn('El módulo de personalización no está disponible.');
          showGenericView();
          return;
        }

        let messageData;
        try {
          const siteBaseUrl = `${window.location.origin}${invitationConfig.basePath || ''}`;
          messageData = window.InvitationMessaging.buildInviteMessage(invitee, {
            baseUrl: window.InvitationMessaging.normalizeBaseUrl
              ? window.InvitationMessaging.normalizeBaseUrl(siteBaseUrl)
              : siteBaseUrl
          });
        } catch (error) {
          console.error('No fue posible componer el mensaje personalizado.', error);
          showGenericView();
          return;
        }

        if (!messageData) return;

        const {
          name,
          heading,
          generalMessage,
          seatsMessage,
          helperText,
          groomWhatsappLink,
          brideWhatsappLink,
          groomWhatsappLabel,
          brideWhatsappLabel
        } = messageData;
        const note = typeof invitee.note === 'string' ? invitee.note.trim() : '';
        const hasGroomWhatsapp = Boolean(groomWhatsappLink);
        const hasBrideWhatsapp = Boolean(brideWhatsappLink);

        if (invitationElements.heading) {
          invitationElements.heading.textContent = heading || `Invitación para ${name}`;
        }
        if (invitationElements.generalMessage) {
          invitationElements.generalMessage.textContent = generalMessage || '';
        }
        if (invitationElements.seatsMessage) {
          invitationElements.seatsMessage.textContent = seatsMessage || '';
          toggleHidden(invitationElements.seatsMessage, !seatsMessage);
        }
        if (invitationElements.note) {
          if (note) {
            invitationElements.note.textContent = note;
            invitationElements.note.classList.remove('hidden');
          } else {
            invitationElements.note.textContent = '';
            invitationElements.note.classList.add('hidden');
          }
        }
        if (invitationElements.whatsappGroom) {
          if (hasGroomWhatsapp) {
            invitationElements.whatsappGroom.href = groomWhatsappLink;
            const label = groomWhatsappLabel
              ? `${groomWhatsappLabel}${name ? ` para ${name}` : ''}`
              : `Confirmar asistencia con Alfredo por WhatsApp${name ? ` para ${name}` : ''}`;
            invitationElements.whatsappGroom.setAttribute('aria-label', label);
            invitationElements.whatsappGroom.classList.remove('hidden');
          } else {
            invitationElements.whatsappGroom.href = '#';
            invitationElements.whatsappGroom.setAttribute(
              'aria-label',
              'Confirmar asistencia con Alfredo por WhatsApp'
            );
            invitationElements.whatsappGroom.classList.add('hidden');
          }
        }
        if (invitationElements.whatsappBride) {
          if (hasBrideWhatsapp) {
            invitationElements.whatsappBride.href = brideWhatsappLink;
            const label = brideWhatsappLabel
              ? `${brideWhatsappLabel}${name ? ` para ${name}` : ''}`
              : `Confirmar asistencia con Carmen por WhatsApp${name ? ` para ${name}` : ''}`;
            invitationElements.whatsappBride.setAttribute('aria-label', label);
            invitationElements.whatsappBride.classList.remove('hidden');
          } else {
            invitationElements.whatsappBride.href = '#';
            invitationElements.whatsappBride.setAttribute(
              'aria-label',
              'Confirmar asistencia con Carmen por WhatsApp'
            );
            invitationElements.whatsappBride.classList.add('hidden');
          }
        }

        const shouldShowActions = hasGroomWhatsapp || hasBrideWhatsapp;
        toggleHidden(invitationElements.actions, !shouldShowActions);
        setCtaMessage(shouldShowActions ? helperText : '');

        toggleHidden(invitationElements.generic, true);
        toggleHidden(invitationElements.personalized, false);
        if (invitationElements.brand) {
          if (heading) {
            invitationElements.brand.setAttribute('title', heading);
          } else {
            invitationElements.brand.removeAttribute('title');
          }
        }
        document.title = heading ? `${heading} · ${originalTitle}` : originalTitle;
        setCardState('personalized');

      };

      const getSlugFromPath = (pathname, basePath) => {
        if (typeof pathname !== 'string' || !pathname) return '';
        const sanitizedBase = typeof basePath === 'string' ? basePath : '';
        let normalizedPath = pathname;
        if (normalizedPath.length > 1) {
          normalizedPath = normalizedPath.replace(/\/+$/g, '');
        }
        let relativePath = normalizedPath;
        if (sanitizedBase) {
          if (relativePath === sanitizedBase) {
            relativePath = '';
          } else if (relativePath.startsWith(`${sanitizedBase}/`)) {
            relativePath = relativePath.slice(sanitizedBase.length);
          }
        }
        relativePath = relativePath.replace(/^\/+/, '').replace(/\/+$/, '');
        if (!relativePath) return '';
        const segments = relativePath.split('/').filter(Boolean);
        if (!segments.length) return '';
        const lastSegment = segments[segments.length - 1];
        try {
          return decodeURIComponent(lastSegment);
        } catch (error) {
          return lastSegment;
        }
      };

      const extractTokens = entry => {
        if (!entry || typeof entry !== 'object') return null;
        const tokenValue = entry.token ?? entry.tokens;
        if (tokenValue == null) return null;
        const values = Array.isArray(tokenValue) ? tokenValue : [tokenValue];
        const normalized = values
          .map(value => (typeof value === 'string' || typeof value === 'number' ? String(value).trim() : ''))
          .filter(Boolean);
        return normalized.length ? normalized : null;
      };

      const sanitizeInvitee = entry => {
        if (!entry || typeof entry !== 'object') return null;
        const slug = typeof entry.slug === 'string' ? entry.slug.trim() : '';
        if (!slug) return null;
        const seats = Number(entry.seats);
        return {
          slug,
          displayName: typeof entry.displayName === 'string' ? entry.displayName.trim() : '',
          relation: typeof entry.relation === 'string' ? entry.relation.trim() : '',
          treatment: typeof entry.treatment === 'string' ? entry.treatment.trim() : '',
          seats: Number.isFinite(seats) ? seats : null,
          note: typeof entry.note === 'string' ? entry.note.trim() : '',
          whatsapp: typeof entry.whatsapp === 'string' ? entry.whatsapp.trim() : '',
          tokens: extractTokens(entry)
        };
      };

      const loadInvitees = (() => {
        let cachedInvitees = null;
        let pendingRequest = null;
        return async () => {
          if (cachedInvitees) return cachedInvitees;
          if (pendingRequest) return pendingRequest;
          pendingRequest = fetch(invitationConfig.dataUrl, {
            cache: 'no-store',
            headers: {
              'Cache-Control': 'no-cache',
              Pragma: 'no-cache'
            }
          })
            .then(response => {
              if (!response.ok) {
                throw new Error(`Error ${response.status} al cargar los invitados.`);
              }
              return response.json();
            })
            .then(data => {
              if (!Array.isArray(data)) {
                throw new Error('El archivo de invitados no tiene el formato esperado.');
              }
              cachedInvitees = data
                .map(sanitizeInvitee)
                .filter(Boolean);
              return cachedInvitees;
            })
            .catch(error => {
              console.error('No fue posible cargar la lista de invitados.', error);
              throw error;
            })
            .finally(() => {
              pendingRequest = null;
            });
          return pendingRequest;
        };
      })();

      const findInvitee = (invitees, slug, token) => {
        if (!Array.isArray(invitees) || !slug) return null;
        const slugLower = slug.toLowerCase();
        const normalizedToken = typeof token === 'string' ? token.trim().toLowerCase() : '';
        for (const invitee of invitees) {
          if (!invitee || typeof invitee.slug !== 'string') continue;
          if (invitee.slug.toLowerCase() !== slugLower) continue;
          if (invitee.tokens && invitee.tokens.length) {
            if (!normalizedToken) return null;
            const hasToken = invitee.tokens.some(value => value.toLowerCase() === normalizedToken);
            if (!hasToken) return null;
          }
          return invitee;
        }
        return null;
      };

      const runPersonalization = async () => {
        if (!invitationElements.card) return;

        showGenericView();

        const slug = getSlugFromPath(window.location.pathname, invitationConfig.basePath);
        if (!slug) {
          return;
        }

        const tokenParam = invitationConfig.tokenParam;
        const searchParams = typeof URLSearchParams !== 'undefined' ? new URLSearchParams(window.location.search) : null;
        const providedToken = tokenParam && searchParams ? searchParams.get(tokenParam) : '';

        setCardState('loading');
        setLoading(true);
        toggleHidden(invitationElements.generic, true);
        toggleHidden(invitationElements.personalized, true);

        try {
          const invitees = await loadInvitees();
          const invitee = findInvitee(invitees, slug, providedToken || '');
          if (invitee) {
            showPersonalizedView(invitee);
          } else {
            console.warn(`No se encontró invitado para el slug "${slug}".`);
            showGenericView();
          }
        } catch (error) {
          showGenericView();
        } finally {
          setLoading(false);
        }
      };

      restoreSpaPath();
      runPersonalization();

      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      const heroNames = document.querySelector('[data-hero-names]');
      const heroDate = document.querySelector('[data-hero-date]');
      const heroFlorals = document.querySelectorAll('[data-hero-floral]');
      const heroLayoutQuery = window.matchMedia('(min-width: 640px)');
      let heroLayoutFrame;

      const applyHeroLayout = () => {
        if (!heroNames || !heroDate) return;

        const isWide = heroLayoutQuery.matches;
        heroNames.style.fontSize = '';

        if (!isWide) {
          heroFlorals.forEach(img => {
            img.style.width = '';
            img.style.height = '';
          });
          return;
        }

        const computedStyle = window.getComputedStyle(heroNames);
        const baseFontSize = parseFloat(computedStyle.fontSize) || 0;
        const gapValue = parseFloat(computedStyle.columnGap || computedStyle.gap || computedStyle.rowGap || '0') || 0;
        const gapCount = Math.max(heroNames.children.length - 1, 0);
        const totalGap = gapValue * gapCount;
        const dateWidth = heroDate.offsetWidth;
        const nameWidth = heroNames.scrollWidth;

        if (!baseFontSize || !dateWidth || !nameWidth) {
          heroFlorals.forEach(img => {
            img.style.width = '';
            img.style.height = '';
          });
          return;
        }

        const contentWidth = Math.max(nameWidth - totalGap, 1);
        const targetContentWidth = Math.max(dateWidth - totalGap, 1);
        const scale = targetContentWidth / contentWidth;
        const clampedScale = Math.min(Math.max(scale, 0.9), 2);
        heroNames.style.fontSize = `${baseFontSize * clampedScale}px`;

        heroFlorals.forEach(img => {
          img.style.width = `${dateWidth}px`;
          img.style.height = 'auto';
        });
      };

      const scheduleHeroLayout = () => {
        cancelAnimationFrame(heroLayoutFrame);
        heroLayoutFrame = requestAnimationFrame(applyHeroLayout);
      };

      if (heroNames && heroDate) {
        scheduleHeroLayout();

        if (document.fonts && document.fonts.ready) {
          document.fonts.ready.then(scheduleHeroLayout);
        } else {
          window.addEventListener('load', scheduleHeroLayout, { once: true });
        }

        heroFlorals.forEach(img => {
          if (img.complete) {
            scheduleHeroLayout();
          } else {
            img.addEventListener('load', scheduleHeroLayout, { once: true });
          }
        });

        if (typeof heroLayoutQuery.addEventListener === 'function') {
          heroLayoutQuery.addEventListener('change', scheduleHeroLayout);
        } else if (typeof heroLayoutQuery.addListener === 'function') {
          heroLayoutQuery.addListener(scheduleHeroLayout);
        }
        window.addEventListener('resize', scheduleHeroLayout, { passive: true });
      }

      // Countdown
      const targetDate = new Date('2025-11-08T13:00:00-06:00').getTime();
      const dayEl = document.getElementById('days');
      const hourEl = document.getElementById('hours');
      const minuteEl = document.getElementById('minutes');
      const secondEl = document.getElementById('seconds');

      const updateCountdown = () => {
        const now = Date.now();
        const distance = Math.max(targetDate - now, 0);

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        dayEl.textContent = days.toString().padStart(2, '0');
        hourEl.textContent = hours.toString().padStart(2, '0');
        minuteEl.textContent = minutes.toString().padStart(2, '0');
        secondEl.textContent = seconds.toString().padStart(2, '0');
      };

      updateCountdown();
      setInterval(updateCountdown, 1000);

      // Reveal animations
      const revealElements = document.querySelectorAll('.reveal');
      if (!prefersReducedMotion && 'IntersectionObserver' in window) {
        const observer = new IntersectionObserver(entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('reveal-visible');
              observer.unobserve(entry.target);
            }
          });
        }, { threshold: 0.25 });
        revealElements.forEach(el => observer.observe(el));
      } else {
        revealElements.forEach(el => el.classList.add('reveal-visible'));
      }

      // Gallery lightbox
      const galleryImages = Array.from(document.querySelectorAll('.gallery-image'));
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightbox-img');
      const lightboxCaption = document.getElementById('lightbox-caption');
      const prevBtn = document.getElementById('lightbox-prev');
      const nextBtn = document.getElementById('lightbox-next');
      const closeBtn = document.getElementById('lightbox-close');
      const body = document.body;
      const mobileBar = document.getElementById('mobile-action-bar');
      let currentIndex = 0;

      const setMobileBarHidden = hidden => {
        if (!mobileBar) return;
        if (hidden) {
          mobileBar.classList.add('hidden');
        } else if (window.scrollY < 60) {
          mobileBar.classList.remove('hidden');
        }
      };

      const updateLightboxImage = () => {
        const image = galleryImages[currentIndex];
        if (!image) return;
        lightboxImg.src = image.src;
        lightboxImg.alt = image.alt;
        lightboxCaption.textContent = image.dataset.caption || '';
      };

      const openLightbox = index => {
        currentIndex = index;
        updateLightboxImage();
        lightbox.classList.add('open');
        body.classList.add('overflow-hidden');
        setMobileBarHidden(true);
        lightbox.focus();
      };

      const closeLightbox = () => {
        lightbox.classList.remove('open');
        body.classList.remove('overflow-hidden');
        setMobileBarHidden(false);
      };

      galleryImages.forEach((image, index) => {
        image.addEventListener('click', () => openLightbox(index));
        image.addEventListener('keydown', event => {
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            openLightbox(index);
          }
        });
        image.setAttribute('tabindex', '0');
      });

      prevBtn.addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
        updateLightboxImage();
      });

      nextBtn.addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % galleryImages.length;
        updateLightboxImage();
      });

      closeBtn.addEventListener('click', closeLightbox);

      lightbox.addEventListener('click', event => {
        if (event.target === lightbox) {
          closeLightbox();
        }
      });

      document.addEventListener('keydown', event => {
        if (!lightbox.classList.contains('open')) return;
        if (event.key === 'Escape') {
          closeLightbox();
        } else if (event.key === 'ArrowRight') {
          currentIndex = (currentIndex + 1) % galleryImages.length;
          updateLightboxImage();
        } else if (event.key === 'ArrowLeft') {
          currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
          updateLightboxImage();
        }
      });

      // Blur-up effect
      const blurImages = document.querySelectorAll('.blur-up');
      blurImages.forEach(img => {
        const handleLoad = () => img.classList.add('loaded');
        if (img.complete) {
          handleLoad();
        } else {
          img.addEventListener('load', handleLoad, { once: true });
        }
      });

      const copyTextToClipboard = async text => {
        const value = typeof text === 'string' ? text.trim() : '';
        if (!value) return false;
        if (navigator.clipboard && navigator.clipboard.writeText) {
          try {
            await navigator.clipboard.writeText(value);
            return true;
          } catch (error) {
            // Fallback to execCommand if direct copy fails
          }
        }
        const textarea = document.createElement('textarea');
        textarea.value = value;
        textarea.setAttribute('readonly', '');
        textarea.style.position = 'absolute';
        textarea.style.opacity = '0';
        textarea.style.pointerEvents = 'none';
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        try {
          textarea.focus({ preventScroll: true });
        } catch (error) {
          textarea.focus();
        }
        textarea.select();
        let succeeded = false;
        try {
          succeeded = document.execCommand('copy');
        } catch (error) {
          succeeded = false;
        }
        document.body.removeChild(textarea);
        return succeeded;
      };

      const initializeBankCard = () => {
        const bankCard = document.querySelector('[data-bank-card]');
        if (!bankCard) return;

        const feedbackElement = bankCard.querySelector('[data-bank-card-feedback]');
        const copyButtons = bankCard.querySelectorAll('[data-clabe]');
        let feedbackTimeoutId;

        const setFlipped = isFlipped => {
          bankCard.classList.toggle('is-flipped', Boolean(isFlipped));
          bankCard.setAttribute('aria-expanded', isFlipped ? 'true' : 'false');
        };

        const showFeedback = message => {
          if (!feedbackElement) return;
          window.clearTimeout(feedbackTimeoutId);
          feedbackElement.textContent = message || '';
          if (message) {
            feedbackElement.classList.add('is-visible');
            feedbackTimeoutId = window.setTimeout(() => {
              feedbackElement.classList.remove('is-visible');
              feedbackElement.textContent = '';
            }, 4000);
          } else {
            feedbackElement.classList.remove('is-visible');
          }
        };

        const toggleFlip = () => {
          const nextState = !bankCard.classList.contains('is-flipped');
          setFlipped(nextState);
          if (!nextState) {
            showFeedback('');
          }
        };

        bankCard.addEventListener('click', event => {
          if (event.target.closest('[data-clabe]')) {
            return;
          }
          toggleFlip();
        });

        bankCard.addEventListener('keydown', event => {
          if (event.target.closest('[data-clabe]')) {
            return;
          }
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            toggleFlip();
          } else if (event.key === 'Escape') {
            setFlipped(false);
          }
        });

        copyButtons.forEach(button => {
          button.addEventListener('click', async event => {
            event.stopPropagation();
            const clabe = (button.dataset.clabe || '').trim();
            const label = (button.dataset.label || '').trim() || 'la cuenta';
            if (!clabe) return;
            const success = await copyTextToClipboard(clabe);
            if (success) {
              button.classList.add('is-copied');
              showFeedback(`CLABE de ${label} copiada al portapapeles.`);
              window.setTimeout(() => {
                button.classList.remove('is-copied');
              }, 1400);
            } else {
              showFeedback('No fue posible copiar la CLABE. Inténtalo nuevamente.');
            }
          });
        });
      };

      initializeBankCard();

      // Audio controls
      const audio = document.getElementById('wedding-audio');
      const toggleButtons = document.querySelectorAll('[data-audio-toggle]');
      const progress = document.getElementById('audio-progress');
      const interactionEvents = ['click', 'keydown', 'touchstart'];
      const setProgressVisual = value => {
        if (!progress) return;
        const percent = Math.max(0, Math.min(100, Number(value)));
        progress.style.setProperty('--progress-percent', `${percent}%`);
      };

      setProgressVisual(0);

      const attachFirstInteractionListeners = () => {
        if (!audio) return;
        const handleFirstInteraction = () => {
          interactionEvents.forEach(eventType => document.removeEventListener(eventType, handleFirstInteraction));
          if (audio.paused) {
            audio.play().catch(() => {
              attachFirstInteractionListeners();
            });
          }
        };

        interactionEvents.forEach(eventType => document.addEventListener(eventType, handleFirstInteraction, { once: true }));
      };

      attachFirstInteractionListeners();

      const updateButtonState = isPlaying => {
        toggleButtons.forEach(button => {
          button.setAttribute('aria-pressed', String(isPlaying));
          const icon = button.querySelector('i');
          if (!icon) return;
          icon.classList.toggle('fa-play', !isPlaying);
          icon.classList.toggle('fa-pause', isPlaying);
        });
      };

      toggleButtons.forEach(button => {
        button.addEventListener('click', () => {
          if (audio.paused) {
            audio.play();
          } else {
            audio.pause();
          }
        });
      });

      audio.addEventListener('play', () => updateButtonState(true));
      audio.addEventListener('pause', () => updateButtonState(false));
      audio.addEventListener('ended', () => {
        updateButtonState(false);
        progress.value = '0';
        progress.setAttribute('aria-valuenow', '0');
        setProgressVisual(0);
      });

      audio.addEventListener('timeupdate', () => {
        const value = audio.duration ? (audio.currentTime / audio.duration) * 100 : 0;
        const displayValue = value.toFixed(0);
        progress.value = displayValue;
        progress.setAttribute('aria-valuenow', displayValue);
        setProgressVisual(value);
      });

      progress.addEventListener('input', event => {
        if (!audio.duration) return;
        const value = Number(event.target.value);
        audio.currentTime = (value / 100) * audio.duration;
        setProgressVisual(value);
      });

      // Mobile sticky actions
      let lastScroll = window.scrollY;
      const handleScroll = () => {
        if (!mobileBar) return;
        const current = window.scrollY;
        if (prefersReducedMotion) {
          if (current > 60) {
            mobileBar.classList.remove('hidden');
          } else {
            mobileBar.classList.add('hidden');
          }
          return;
        }
        if (current > lastScroll && current > 60) {
          mobileBar.classList.add('hidden');
        } else if (current < lastScroll || current < 60) {
          mobileBar.classList.remove('hidden');
        }
        lastScroll = current;
      };

      if (mobileBar) {
        mobileBar.classList.toggle('hidden', window.scrollY > 60);
        window.addEventListener('scroll', handleScroll, { passive: true });
      }

      // QR code generation
      if (window.QRCode) {
        const qrCanvas = document.getElementById('qr-canvas');
        QRCode.toCanvas(qrCanvas, 'https://mega.nz/filerequest/QHyE53BPyTg', {
          errorCorrectionLevel: 'H',
          margin: 1,
          width: 180,
          color: {
            dark: '#2F4F4F',
            light: '#FAF7F2'
          }
        });
      }
    });
  </script>
</body>
</html>
